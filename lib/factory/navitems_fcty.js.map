{"version":3,"sources":["../../src/factory/navitems_fcty.js"],"names":[],"mappings":"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","file":"navitems_fcty.js","sourcesContent":["const _     = require(\"lodash\");\nconst CheckActive = require(\"../utils/check_active\");\n\nfunction add_id(item){\n  item.id = _.uniqueId(\"navitem\");\n  return item\n}\n\nfunction checkSubs(navitems){\n  let check = false;\n  _.forEach(navitems, (ni)=>{\n    if(_.has(ni, \"sub\")){\n       check = true;\n       return false;\n    }\n  });\n\n  return check;\n}\n\nfunction checkLevels(navitem){\n\n  if(!_.has(navitem, \"sub\")) return navitem.level;\n  let level = 1;\n  let check = false;\n  _.forEach(navitem.sub, (ni)=>{\n    if(_.has(ni, \"sub\")){\n      level = 2;\n      return false;\n    }\n  });\n  // console.log(navitem.title, level)\n  return level\n}\n\nfunction findNavItem(navitems, id, item){\n  if(item) return item;\n  if(_.isEmpty(navitems)) return null;\n  return _.reduce(navitems, (prev, curr)=>{\n    if(curr.id === id){\n      return curr;\n    }\n    let sub;\n    if(_.has(curr, \"sub\")){\n      sub = findNavItem(curr.sub, id, prev);\n    }\n\n    return (_.isObject(sub)) ? sub : prev\n  }, item);\n}\n\nfunction processItems(data, isActive, level=0){\n  if(!data) return null;\n  return _.map(data, (ni)=>{\n    ni        = add_id(ni);\n    ni.level  = level;\n    ni.active = isActive(ni.path);\n    if(_.has(ni, \"sub\")){\n      ni.sub = processItems(ni.sub, isActive, level+1);\n    }\n    return ni;\n  });\n}\n\nfunction setActive(data, id, isActive){\n  let active = false;\n  data = _.map(data, (ni)=>{\n    ni.active = (_.isNull(id)) ? isActive(ni.path) : (ni.id === id);\n    if(ni.active){\n      active = true;\n      return ni;\n    }\n\n    if(_.has(ni, \"sub\")){\n      let sub = setActive(ni.sub, id, isActive);\n      if(sub.active){\n        ni.sub = sub.data\n        ni.active = active =  sub.active;\n      }\n    }\n\n    return ni;\n  });\n\n  return {data:data, active:active}\n}\n\nmodule.exports = function(data){\n  let isActive = CheckActive();\n  let navitems = processItems(data, isActive);\n\n\n  navitems = _.map(navitems, (ni)=>{\n    ni.fullLevels = checkLevels(ni);\n    return ni;\n  });\n\n\n  let obj = {\n      findItem:(id)=>findNavItem(navitems, id)\n    , getSub:(id)=>{\n      let item = findNavItem(navitems, id);\n      // console.log(\"sub\", item)\n      if(item && _.has(item, \"sub\")) return item.sub;\n    }\n    , setActive:(id)=>{\n      navitems = setActive(navitems, id, isActive).data;\n    }\n    , getRoots:()=>navitems\n    , getLevels:()=>{\n      return _.find(navitems, (ni)=>ni.active).fullLevels\n    }\n    , getLevelType:(id)=>{\n      let item = findNavItem(navitems, id);\n      if(item){\n        return (_.has(item, \"fullLevels\")) ? item.fullLevels : item.level;\n      }\n\n      return null;\n    }\n  }\n\n  return obj;\n\n}"]}